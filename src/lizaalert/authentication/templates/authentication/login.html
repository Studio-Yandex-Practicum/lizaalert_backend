{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}{{ block.super }}<link rel="stylesheet" href="{% static "admin/css/login.css" %}">
{{ form.media }}
{% endblock %}

{% block extrahead %}
<meta http-equiv="Content-Security-Policy" content="
default-src 'self'; 
font-src 'self' data:;
script-src 'self' 'unsafe-inline' https://passport.yandex.ru https://yastatic.net; 
style-src 'self' 'unsafe-inline' https://yastatic.net; 
child-src https://passport.yandex.ru; 
frame-src https://passport.yandex.ru https://autofill.yandex.ru; 
connect-src https://passport.yandex.ru https://autofill.yandex.ru;">
<script src="https://yastatic.net/s3/passport-sdk/autofill/v1/sdk-suggest-with-polyfills-latest.js"></script>
{% endblock %}

{% block bodyclass %}{{ block.super }} login{% endblock %}

{% block usertools %}{% endblock %}

{% block nav-global %}{% endblock %}

{% block nav-sidebar %}{% endblock %}

{% block content_title %}{% endblock %}

{% block nav-breadcrumbs %}{% endblock %}

{% block content %}
{% if form.errors and not form.non_field_errors %}
<p class="errornote">
{% blocktranslate count counter=form.errors.items|length %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktranslate %}
</p>
{% endif %}

{% if form.non_field_errors %}
{% for error in form.non_field_errors %}
<p class="errornote">
    {{ error }}
</p>
{% endfor %}
{% endif %}

<div id="content-main">

{% if user.is_authenticated %}
<p class="errornote">
{% blocktranslate trimmed %}
    You are authenticated as {{ username }}, but are not authorized to
    access this page. Would you like to login to a different account?
{% endblocktranslate %}
</p>
{% endif %}
<div class="form-row">
<script>
  window.onload = function() {
    window.YaAuthSuggest.init({
        client_id: '48ffa8bf752e49a988525882568e8022',
        response_type: 'token',
        redirect_uri: 'https://1034-2a02-6b8-b081-7323-00-1-13.ngrok-free.app/admin/'
      },
      'https://1034-2a02-6b8-b081-7323-00-1-13.ngrok-free.app/admin/',
      {
        view: "button",
        parentId: "buttonContainerId",
        buttonSize: 'm',
        buttonView: 'main',
        buttonTheme: 'light',
        buttonBorderRadius: "0",
        buttonIcon: 'ya',
      }
      )
    .then(({handler}) => handler())
    .then(data => console.log('Сообщение с токеном', data))
    .catch(error => console.log('Обработка ошибки', error))
  }
  </script>

</div>
</div>
{% endblock %}